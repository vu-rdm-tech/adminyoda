{% extends "base.html" %}

{% block content %}
    <h1>Project list</h1>
    <table class="table">
        <thead>
        <th scope="col">Title</th>
        <th scope="col">Faculty</th>
        <th scope="col">Department</th>
        <th scope="col">Groups</th>
        <th scope="col">Datasets</th>
        <th scope="col">Published</th>
        <th scope="col">Size</th>
        </thead>
        <tbody>
        {% for p in projects %}

            <tr>
                <td>{{ p.title }}</td>
                <td>{{ p.faculty }}</td>
                <td>{{ p.department }}</td>
                <td>{{ p.num_groups }}</td>
                <td>{{ p.num_dataset }}</td>
                <td>{{ p.num_published }}</td>
                <td>{{ p.size }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    <canvas id="faculty-chart" data-url="{% url 'faculty_chart_json' %}"></canvas>
    <script>

        function setPieChart(chart, title) {
            $.ajax({
                url: chart.data("url"),
                success: function (data) {

                    var ctx = chart[0].getContext("2d");

                    var options = {
                        responsive: true,
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: title
                        },
                    }

                    new Chart(ctx, {
                        type: 'pie',
                        data: {
                            labels: data.labels,
                            datasets: data.datasets
                        },
                        options: options
                    });

                }
            });
        }

        $(function () {
            setPieChart($("#faculty-chart"), 'Projects per faculty', false);
        });
    </script>
{% endblock %}
